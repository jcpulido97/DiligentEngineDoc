<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GraphicsEngineD3D11 | Diligent Engine</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Diligent Engine</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          GraphicsEngineD3D11
        </h1>
<p>Implementation of Direct3D11 back-end</p><section id="autotoc_md1"><h2><a href="#autotoc_md1">Initialization</a></h2><p>The following code snippet shows how to initialize <a href="namespaceDiligent.html" class="m-doc">Diligent</a> Engine in Direct3D11 mode.</p><pre class="m-code"><span class="cp">#include</span> <span class="cpf">&quot;EngineFactoryD3D11.h&quot;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">Diligent</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="n">EngineD3D11CreateInfo</span> <span class="n">EngineCI</span><span class="p">;</span>
<span class="n">EngineCI</span><span class="p">.</span><span class="n">DebugFlags</span> <span class="o">=</span>
    <span class="n">D3D11_DEBUG_FLAG_VERIFY_COMMITTED_SHADER_RESOURCES</span><span class="p">;</span>

<span class="c1">// Get pointer to the function that returns the factory</span>
<span class="cp">#if ENGINE_DLL</span>
    <span class="c1">// Load the dll and import GetEngineFactoryD3D11() function</span>
    <span class="k">auto</span> <span class="n">GetEngineFactoryD3D11</span> <span class="o">=</span> <span class="n">LoadGraphicsEngineD3D11</span><span class="p">();</span>
<span class="cp">#endif</span>
<span class="k">auto</span><span class="o">*</span> <span class="n">pFactoryD3D11</span> <span class="o">=</span> <span class="n">GetEngineFactoryD3D11</span><span class="p">();</span>

<span class="n">RefCntAutoPtr</span><span class="o">&lt;</span><span class="n">IRenderDevice</span><span class="o">&gt;</span> <span class="n">pRenderDevice</span><span class="p">;</span>
<span class="n">RefCntAutoPtr</span><span class="o">&lt;</span><span class="n">IDeviceContext</span><span class="o">&gt;</span> <span class="n">pImmediateContext</span><span class="p">;</span>
<span class="n">SwapChainDesc</span> <span class="n">SwapChainDesc</span><span class="p">;</span>
<span class="n">RefCntAutoPtr</span><span class="o">&lt;</span><span class="n">ISwapChain</span><span class="o">&gt;</span> <span class="n">pSwapChain</span><span class="p">;</span>
<span class="n">pFactoryD3D11</span><span class="o">-&gt;</span><span class="n">CreateDeviceAndContextsD3D11</span><span class="p">(</span><span class="n">EngineCI</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pRenderDevice</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pImmediateContext</span><span class="p">);</span>
<span class="n">NativeWindow</span> <span class="n">Window</span><span class="p">;</span>
<span class="n">Window</span><span class="p">.</span><span class="n">hWnd</span> <span class="o">=</span> <span class="n">hWnd</span><span class="p">;</span>
<span class="n">pFactoryD3D11</span><span class="o">-&gt;</span><span class="n">CreateSwapChainD3D11</span><span class="p">(</span><span class="n">pRenderDevice</span><span class="p">,</span> <span class="n">pImmediateContext</span><span class="p">,</span> <span class="n">SwapChainDesc</span><span class="p">,</span> <span class="n">Window</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pSwapChain</span><span class="p">);</span></pre><p>Alternatively, the engine can be initialized by attaching to existing D3D11 device and immediate context (see below).</p></section><section id="autotoc_md2"><h2><a href="#autotoc_md2">Interoperability with Direct3D11</a></h2><p><a href="namespaceDiligent.html" class="m-doc">Diligent</a> Engine exposes methods to access internal D3D11 objects, is able to create diligent engine buffers and textures from existing Direct3D11 buffers and textures, and can be initialized by attaching to existing D3D11 device and immediate context.</p><section id="autotoc_md3"><h3><a href="#autotoc_md3">Accessing Native Direct3D11 objects</a></h3><p>Below are some of the methods that provide access to internal D3D11 objects:</p><table class="m-table"><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>ID3D11Buffer* IBufferD3D11::GetD3D11Buffer()</code></td><td>returns a pointer to the <code>ID3D11Buffer</code> interface of the internal Direct3D11 buffer object</td></tr><tr><td><code>ID3D11Resource* ITextureD3D11::GetD3D11Texture()</code></td><td>returns a pointer to the <code>ID3D11Resource</code> interface of the internal Direct3D11 texture object</td></tr><tr><td><code>ID3D11View* IBufferViewD3D11()::GetD3D11View()</code></td><td>returns a pointer to the <code>ID3D11View</code> interface of the internal Direct3D11 object representing the buffer view</td></tr><tr><td><code>ID3D11View* ITextureViewD3D11::GetD3D11View()</code></td><td>returns a pointer to the <code>ID3D11View</code> interface of the internal Direct3D11 object representing the texture view</td></tr><tr><td><code>ID3D11Device* IRenderDeviceD3D11::GetD3D11Device()</code></td><td>returns a pointer to the native Direct3D11 device object</td></tr><tr><td><code>ID3D11DeviceContext* IDeviceContextD3D11::GetD3D11DeviceContext()</code></td><td>returns a pointer to the native <code>ID3D11DeviceContext</code> object</td></tr></tbody></table></section><section id="autotoc_md4"><h3><a href="#autotoc_md4">Creating Diligent Engine Objects from Direct3D11 Resources</a></h3><ul><li><code>void IRenderDeviceD3D11::CreateBufferFromD3DResource(ID3D11Buffer* pd3d11Buffer, const BufferDesc&amp; BuffDesc, RESOURCE_STATE InitialState, IBuffer** ppBuffer)</code> - creates a <a href="namespaceDiligent.html" class="m-doc">Diligent</a> Engine buffer object from the native Direct3D11 buffer</li><li><code>void IRenderDeviceD3D11::CreateTextureFromD3DResource(ID3D11Texture1D* pd3d11Texture, RESOURCE_STATE InitialState, ITexture** ppTexture)</code> - create a <a href="namespaceDiligent.html" class="m-doc">Diligent</a> Engine texture object from the native Direct3D11 1D texture</li><li><code>void IRenderDeviceD3D11::CreateTextureFromD3DResource(ID3D11Texture2D* pd3d11Texture, RESOURCE_STATE InitialState, ITexture** ppTexture)</code> - create a <a href="namespaceDiligent.html" class="m-doc">Diligent</a> Engine texture object from the native Direct3D11 2D texture</li><li><code>void IRenderDeviceD3D11::CreateTextureFromD3DResource(ID3D11Texture3D* pd3d11Texture, RESOURCE_STATE InitialState, ITexture** ppTexture)</code> - create a <a href="namespaceDiligent.html" class="m-doc">Diligent</a> Engine texture object from the native Direct3D11 3D texture</li></ul></section><section id="autotoc_md5"><h3><a href="#autotoc_md5">Initializing the Engine by Attaching to Existing Direct3D11 Device and Immediate Context</a></h3><p>The code snippet below shows how diligent engine can be attached to Direct3D11 device returned by Unity</p><pre class="m-code"><span class="n">IUnityGraphicsD3D11</span><span class="o">*</span> <span class="n">d3d</span> <span class="o">=</span> <span class="n">interfaces</span><span class="o">-&gt;</span><span class="n">Get</span><span class="o">&lt;</span><span class="n">IUnityGraphicsD3D11</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">ID3D11Device</span><span class="o">*</span> <span class="n">d3d11NativeDevice</span> <span class="o">=</span> <span class="n">d3d</span><span class="o">-&gt;</span><span class="n">GetDevice</span><span class="p">();</span>
<span class="n">CComPtr</span><span class="o">&lt;</span><span class="n">ID3D11DeviceContext</span><span class="o">&gt;</span> <span class="n">d3d11ImmediateContext</span><span class="p">;</span>
<span class="n">d3d11NativeDevice</span><span class="o">-&gt;</span><span class="n">GetImmediateContext</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d3d11ImmediateContext</span><span class="p">);</span>
<span class="k">auto</span><span class="o">*</span> <span class="n">pFactoryD3d11</span> <span class="o">=</span> <span class="n">GetEngineFactoryD3D11</span><span class="p">();</span>
<span class="n">EngineD3D11CreateInfo</span> <span class="n">EngineCI</span><span class="p">;</span>
<span class="n">pFactoryD3d11</span><span class="o">-&gt;</span><span class="n">AttachToD3D11Device</span><span class="p">(</span><span class="n">d3d11NativeDevice</span><span class="p">,</span> <span class="n">d3d11ImmediateContext</span><span class="p">,</span> <span class="n">EngineCI</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_Device</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_Context</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span></pre><p>For more information about interoperability with Direct3D11, please visit <a href="http://diligentgraphics.com/diligent-engine/native-api-interoperability/direct3d11-interoperability/">Diligent Engine web site</a></p></section></section><section id="autotoc_md6"><h2><a href="#autotoc_md6">References</a></h2><p><a href="http://diligentgraphics.com/diligent-engine/native-api-interoperability/direct3d11-interoperability/">Interoperability with Direct3D11</a></p><p><a href="http://diligentgraphics.com/diligent-engine/architecture/d3d11">Architecture of D3D11-based implementation</a></p><hr/><p><a href="http://diligentgraphics.com">diligentgraphics.com</a></p><p><a href="https://twitter.com/diligentengine"><img class="m-image" src="twitter.png" alt="Image" /></a> <a href="https://www.facebook.com/DiligentGraphics/"><img class="m-image" src="facebook.png" alt="Image" /></a></p></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Diligent Engine. Created with <a href="https://doxygen.org/">Doxygen</a> 1.8.17 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
